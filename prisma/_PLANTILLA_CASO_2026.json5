/**
 * 游낀 PLANTILLA DE CASO CL칈NICO - KLINIK-MAT
 * 
 * Versi칩n: 2.0 (Enero 2026)
 * Sistema: 480 casos / 6 치reas / 24 sub치reas
 * 
 * ESTRUCTURA DE DIFICULTAD:
 * - BAJA (1):  6 preguntas MCQ
 * - MEDIA (2): 6 MCQ + 1 SHORT con criterios
 * - ALTA (3):  7 MCQ + 1 SHORT con criterios
 * 
 * FILOSOF칈A:
 * - Aprendizaje progresivo
 * - Toma de decisiones cl칤nicas
 * - Integraci칩n de materias
 * - Pensamiento cl칤nico estructurado
 */

{
  // ============================================================================
  // 游늶 METADATOS DEL CASO
  // ============================================================================
  
  id: 'area-subarea-tema-###',  // Ej: emb-cpn-normal-001
  version: 1,
  title: 'T칤tulo descriptivo del caso cl칤nico',
  
  // Categorizaci칩n
  area: 'Embarazo y Control Prenatal', // Ver CLINICAL_AREAS
  modulo: 'Control Prenatal Normal', // Sub치rea espec칤fica
  difficulty: 1, // 1=Baja(6 MCQ), 2=Media(6 MCQ+1 SHORT), 3=Alta(7 MCQ+1 SHORT)
  
  // ============================================================================
  // 游닀 ESCENARIO CL칈NICO
  // ============================================================================
  
  vignette: `
Paciente de [edad] a침os, [antecedentes relevantes], consulta por [motivo de consulta principal].
  
**Historia cl칤nica:**
[Descripci칩n detallada del caso, antecedentes relevantes]

**Examen f칤sico:**
- Signos vitales: ...
- Examen segmentario: ...

**Ex치menes complementarios:**
- Laboratorio: ...
- Im치genes: ...

[Evoluci칩n si aplica]
  `,

  // 游꿢 ESTRUCTURA DE PREGUNTAS
  questions: [
    // ========================================
    // MCQ QUESTIONS (6 o 7 seg칰n dificultad)
    // ========================================
    {
      id: nanoid(),
      order: 1,
      tipo: 'mcq',
      enunciado: '쮺u치l es el diagn칩stico m치s probable?',
      opciones: [
        {
          id: nanoid(),
          texto: '[Opci칩n correcta]',
          esCorrecta: true,
          explicacion: 'Explicaci칩n detallada de por qu칠 es correcta...',
          order: 1,
        },
        {
          id: nanoid(),
          texto: 'Opci칩n incorrecta 1',
          esCorrecta: false,
          explicacion: 'Esta opci칩n es incorrecta porque...',
          order: 2,
        },
        // ... m치s opciones
      ],
    },
    // ... m치s preguntas MCQ seg칰n dificultad
  ],
  
  // SHORT questions para dificultad MEDIA y ALTA
  shortQuestions: [
    {
      tipo: 'short',
      enunciado: '쮺u치l es el criterio diagn칩stico m치s importante que utilizar칤as para confirmar esta patolog칤a?',
      criteriosEvaluacion: [
        {
          criterio: 'Identifica el criterio diagn칩stico principal',
          puntos: 3,
          esencial: true,
        },
        {
          criterio: 'Menciona valores de corte espec칤ficos',
          puntos: 2,
          esencial: true,
        },
        {
          criterio: 'Considera diagn칩stico diferencial',
          puntos: 1,
          esencial: false,
        },
      ],
      respuestaModelo: 'Modelo de respuesta esperada...',
      feedbackDocente: 'Puntos clave que el docente debe evaluar...',
    },
  ],
} as const;

// ============================================================================
// 游댢 UTILIDADES
// ============================================================================

export function getCasePath(area: string, subarea: string, caseId: string): string {
  return `${CASE_FOLDER_STRUCTURE.BASE_PATH}/${area}/${subarea}/${caseId}.json5`;
}

export function getCaseCount(): { total: number; byArea: Record<string, number>; byDifficulty: Record<number, number> } {
  const areas = Object.values(CLINICAL_AREAS);
  const byArea = areas.reduce((acc, area) => {
    acc[area.code] = area.totalCases;
    return acc;
  }, {} as Record<string, number>);

  return {
    total: CLINICAL_CASES_CONFIG.TOTAL_CASES,
    byArea: CLINICAL_CASES_CONFIG.CASES_PER_AREA,
    bySubarea: CLINICAL_CASES_CONFIG.CASES_PER_SUBAREA,
    difficultyDistribution: DIFFICULTY_DISTRIBUTION,
  };
}

export function getCaseFileName(areaId: string, subareaId: string, caseNumber: number, slug: string): string {
  return `${slug}-${String(caseNumber).padStart(3, '0')}.json5`;
}

export function getCaseFolderPath(category: string, areaId: string, subareaId: string): string {
  return `${CASE_FOLDER_STRUCTURE.BASE_PATH}/${category}/${areaId}/${subareaId}/`;
}
